name: face-recognition
services:
  frontend:
    build: ./frontend
    image: face-frontend:dev
    container_name: face_frontend
    ports:
      - "80:80"
    volumes:
      - ./frontend:/usr/share/nginx/html
    networks:
      - face-net

  backend:
    build: 
      context: ./backend
    image: face-backend:dev
    container_name: face_backend
    ports:
      - "8080:8080"
    volumes:
      - ./backend:/app
    networks:
      - face-net
    command: >
      bash -c "mkdir -p /app/build &&
               cd /app/build &&
               cmake .. &&
               make -j$$(nproc) &&
               ./backend"

networks:
  face-net: